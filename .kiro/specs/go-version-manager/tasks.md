# 任务列表

## 任务 1: 项目初始化和基础结构

**需求追溯**: 所有需求

**描述**: 创建项目目录结构，初始化 Go 模块，定义核心数据模型

**验收标准**:
- [ ] 创建项目目录结构（cmd, internal, pkg）
- [ ] 初始化 go.mod 文件
- [ ] 定义 Version 数据模型
- [ ] 定义 Config 数据模型
- [ ] 项目可以成功编译

**依赖**: 无

---

## 任务 2: 实现本地存储模块

**需求追溯**: 需求 3.4, 6.2

**描述**: 实现本地元数据存储功能，包括保存、加载、删除版本信息

**验收标准**:
- [ ] 实现 LocalStorage 接口
- [ ] 实现元数据的保存和加载（JSON 格式）
- [ ] 实现当前版本标记的读写
- [ ] 实现获取安装路径的方法
- [ ] 通过属性 3（元数据持久化往返属性）测试

**依赖**: 任务 1

---

## 任务 3: 实现远程版本源客户端

**需求追溯**: 需求 1

**描述**: 实现从 Go 官方源获取版本列表的功能

**验收标准**:
- [ ] 实现 RemoteClient 接口
- [ ] 实现从 https://go.dev/dl/?mode=json 获取版本列表
- [ ] 实现 JSON 响应解析
- [ ] 实现版本列表过滤（仅 Linux 平台）
- [ ] 实现版本列表排序（降序）
- [ ] 通过属性 1（版本列表排序不变性）测试
- [ ] 处理网络错误情况

**依赖**: 任务 1

---

## 任务 4: 实现版本下载和校验功能

**需求追溯**: 需求 3.1, 3.2

**描述**: 实现下载 Go 安装包和校验和验证功能

**验收标准**:
- [ ] 实现下载指定版本的安装包
- [ ] 实现下载进度显示
- [ ] 实现 SHA256 校验和验证
- [ ] 通过属性 9（校验和验证正确性）测试
- [ ] 处理下载失败情况

**依赖**: 任务 3

---

## 任务 5: 实现版本安装功能

**需求追溯**: 需求 3

**描述**: 实现完整的版本安装流程，包括下载、验证、解压、保存元数据

**验收标准**:
- [ ] 实现版本已安装检查
- [ ] 实现 tar.gz 解压功能
- [ ] 实现安装到指定目录
- [ ] 实现安装后保存元数据
- [ ] 实现安装失败时的清理
- [ ] 通过属性 2（版本安装幂等性）测试
- [ ] 通过属性 6（安装失败清理属性）测试
- [ ] 处理各种错误情况

**依赖**: 任务 2, 任务 4

---

## 任务 6: 实现环境配置服务

**需求追溯**: 需求 4

**描述**: 实现环境变量配置和 shell 配置文件更新功能

**验收标准**:
- [ ] 实现 EnvManager 接口
- [ ] 实现 shell 类型检测（bash, zsh）
- [ ] 实现 shell 配置文件选择
- [ ] 通过属性 8（Shell 配置文件选择正确性）测试
- [ ] 实现配置块的添加和更新
- [ ] 实现 GOROOT、PATH、GOPATH 配置
- [ ] 处理配置文件不存在的情况

**依赖**: 任务 1

---

## 任务 7: 实现版本切换功能

**需求追溯**: 需求 4

**描述**: 实现切换到指定 Go 版本的功能

**验收标准**:
- [ ] 实现版本已安装检查
- [ ] 实现设置当前版本
- [ ] 实现环境变量配置
- [ ] 实现 shell 配置文件更新
- [ ] 通过属性 4（版本切换一致性）测试
- [ ] 提示用户重新加载 shell 配置
- [ ] 处理版本未安装的错误

**依赖**: 任务 2, 任务 6

---

## 任务 8: 实现版本列表查询功能

**需求追溯**: 需求 1, 2, 5

**描述**: 实现查询远程可用版本、本地已安装版本、当前使用版本的功能

**验收标准**:
- [ ] 实现 -remote 命令（列出远程版本）
- [ ] 实现 -list 命令（列出本地版本）
- [ ] 实现 current 命令（显示当前版本）
- [ ] 实现版本格式化输出
- [ ] 通过属性 7（版本格式化输出完整性）测试
- [ ] 通过属性 10（当前版本查询一致性）测试
- [ ] 标记当前正在使用的版本
- [ ] 处理空列表情况

**依赖**: 任务 2, 任务 3

---

## 任务 9: 实现版本卸载功能

**需求追溯**: 需求 6

**描述**: 实现卸载指定 Go 版本的功能

**验收标准**:
- [ ] 实现版本已安装检查
- [ ] 实现删除版本目录
- [ ] 实现删除版本元数据
- [ ] 通过属性 5（卸载完整性）测试
- [ ] 实现卸载当前版本的警告和确认
- [ ] 显示卸载后的剩余版本列表
- [ ] 处理版本未安装的错误

**依赖**: 任务 2

---

## 任务 10: 实现 CLI 命令层

**需求追溯**: 需求 8

**描述**: 实现命令行界面，解析用户命令和参数

**验收标准**:
- [ ] 实现命令解析（flag 包）
- [ ] 实现 -remote 命令处理
- [ ] 实现 -list 命令处理
- [ ] 实现 install 命令处理
- [ ] 实现 use 命令处理
- [ ] 实现 current 命令处理
- [ ] 实现 uninstall 命令处理
- [ ] 实现 -help 命令处理
- [ ] 实现 -version 命令处理
- [ ] 实现无效命令的错误处理
- [ ] 实现统一的错误输出格式

**依赖**: 任务 5, 任务 7, 任务 8, 任务 9

---

## 任务 11: 实现平台检测和兼容性

**需求追溯**: 需求 7

**描述**: 实现 Linux 发行版和架构检测，确保跨平台兼容性

**验收标准**:
- [ ] 实现操作系统检测
- [ ] 实现架构检测（amd64, arm64, 386）
- [ ] 实现不支持平台的错误处理
- [ ] 在 CentOS 上测试（如果可能）
- [ ] 在 Ubuntu 上测试（如果可能）
- [ ] 实现权限检查和提示

**依赖**: 任务 1

---

## 任务 12: 集成测试和文档

**需求追溯**: 所有需求

**描述**: 编写集成测试，完善文档

**验收标准**:
- [ ] 编写端到端集成测试
- [ ] 测试完整的安装-切换-卸载流程
- [ ] 编写 README.md 文档
- [ ] 编写使用示例
- [ ] 编写故障排除指南
- [ ] 所有测试通过
- [ ] 代码覆盖率达到 80% 以上

**依赖**: 任务 10, 任务 11

---

## 任务 13: 构建和发布

**需求追溯**: 所有需求

**描述**: 构建可执行文件，准备发布

**验收标准**:
- [ ] 配置构建脚本
- [ ] 构建 Linux amd64 版本
- [ ] 构建 Linux arm64 版本
- [ ] 构建 Linux 386 版本
- [ ] 测试构建的可执行文件
- [ ] 编写安装说明
- [ ] 准备发布说明

**依赖**: 任务 12
